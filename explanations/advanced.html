<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Advanced topics - Epinio - the application development engine for Kubernetes</title>
        <!-- Custom HTML head -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('set','anonymizeIp',!0);
ga('create', 'UA-56382716-12', 'auto');
ga('send', 'pageview');
</script>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for users and developers of Epinio">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../tutorials/quickstart.html"><strong aria-hidden="true">2.</strong> Quick Start</a></li><li class="chapter-item expanded "><a href="../installation/installation.html"><strong aria-hidden="true">3.</strong> Installation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../installation/system_requirements.html"><strong aria-hidden="true">3.1.</strong> System Requirements</a></li><li class="chapter-item "><a href="../installation/install_epinio_auto.html"><strong aria-hidden="true">3.2.</strong> Method 1: Install Epinio and automatically install dependencies</a></li><li class="chapter-item "><a href="../installation/install_epinio_manual.html"><strong aria-hidden="true">3.3.</strong> Method 2: Install Epinio and manually install dependencies</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_rancher.html"><strong aria-hidden="true">3.4.</strong> Install Epinio on Rancher</a></li><li class="chapter-item "><a href="../installation/install_epinio_cli.html"><strong aria-hidden="true">3.5.</strong> Install Epinio cli</a></li><li class="chapter-item "><a href="../installation/install_epinio_customDNS.html"><strong aria-hidden="true">3.6.</strong> Install Epinio with custom DNS</a></li><li class="chapter-item "><a href="../installation/install_epinio_magicDNS.html"><strong aria-hidden="true">3.7.</strong> Install Epinio with &quot;magic&quot; DNS</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_aks.html"><strong aria-hidden="true">3.8.</strong> Install Epinio on AKS (Azure)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_eks.html"><strong aria-hidden="true">3.9.</strong> Install Epinio on EKS (Amazon)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_gke.html"><strong aria-hidden="true">3.10.</strong> Install Epinio on GKE (Google)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_rke.html"><strong aria-hidden="true">3.11.</strong> Install Epinio on RKE2 (Rancher)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_k3d.html"><strong aria-hidden="true">3.12.</strong> Install Epinio on k3d (local)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_k3s.html"><strong aria-hidden="true">3.13.</strong> Install Epinio on k3s (local)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_rancher_desktop.html"><strong aria-hidden="true">3.14.</strong> Install Epinio on Rancher Desktop (local)</a></li><li class="chapter-item "><a href="../installation/install_epinio_on_minikube.html"><strong aria-hidden="true">3.15.</strong> Install Epinio on Minikube (local)</a></li><li class="chapter-item "><a href="../installation/install_wordpress_application.html"><strong aria-hidden="true">3.16.</strong> Install Wordpress on Epinio</a></li></ol></li><li class="chapter-item expanded "><a href="../installation/uninstall_epinio.html"><strong aria-hidden="true">4.</strong> Uninstall Epinio</a></li><li class="chapter-item expanded "><a href="../explanations/explanations.html"><strong aria-hidden="true">5.</strong> Explanations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../explanations/advanced.html" class="active"><strong aria-hidden="true">5.1.</strong> Advanced topics</a></li><li class="chapter-item "><a href="../explanations/configuration.html"><strong aria-hidden="true">5.2.</strong> Configuration</a></li><li class="chapter-item "><a href="../explanations/detailed-push-process.html"><strong aria-hidden="true">5.3.</strong> Detailed Push Process</a></li><li class="chapter-item "><a href="../explanations/principles.html"><strong aria-hidden="true">5.4.</strong> Principles</a></li><li class="chapter-item "><a href="../explanations/security.html"><strong aria-hidden="true">5.5.</strong> Security</a></li><li class="chapter-item "><a href="../explanations/windows.html"><strong aria-hidden="true">5.6.</strong> Windows</a></li></ol></li><li class="chapter-item expanded "><a href="../howtos/howtos.html"><strong aria-hidden="true">6.</strong> HowTos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../howtos/certificate_issuers.html"><strong aria-hidden="true">6.1.</strong> Certificate Issuers</a></li><li class="chapter-item "><a href="../howtos/provision_external_ip_for_local_kubernetes.html"><strong aria-hidden="true">6.2.</strong> Provision external IP address for local Kubernetes</a></li><li class="chapter-item "><a href="../howtos/gitjob_push.html"><strong aria-hidden="true">6.3.</strong> Push with gitjob</a></li><li class="chapter-item "><a href="../howtos/setup-external-s3.html"><strong aria-hidden="true">6.4.</strong> Setup external S3 storage</a></li><li class="chapter-item "><a href="../howtos/setup-external-registry.html"><strong aria-hidden="true">6.5.</strong> Setup external container registry</a></li></ol></li><li class="chapter-item expanded "><a href="../references/references.html"><strong aria-hidden="true">7.</strong> Reference documentation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/index.html"><strong aria-hidden="true">7.1.</strong> Command requirements</a></li><li class="chapter-item "><a href="../references/commands.html"><strong aria-hidden="true">7.2.</strong> Command reference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio.html"><strong aria-hidden="true">7.2.1.</strong> epinio</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_app.html"><strong aria-hidden="true">7.2.1.1.</strong> epinio_app</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_app_create.html"><strong aria-hidden="true">7.2.1.1.1.</strong> epinio_app_create</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_delete.html"><strong aria-hidden="true">7.2.1.1.2.</strong> epinio_app_delete</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_env.html"><strong aria-hidden="true">7.2.1.1.3.</strong> epinio_app_env</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_app_env_list.html"><strong aria-hidden="true">7.2.1.1.3.1.</strong> epinio_app_env_list</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_env_set.html"><strong aria-hidden="true">7.2.1.1.3.2.</strong> epinio_app_env_set</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_env_show.html"><strong aria-hidden="true">7.2.1.1.3.3.</strong> epinio_app_env_show</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_env_unset.html"><strong aria-hidden="true">7.2.1.1.3.4.</strong> epinio_app_env_unset</a></li></ol></li><li class="chapter-item "><a href="../references/cli/epinio_app_list.html"><strong aria-hidden="true">7.2.1.1.4.</strong> epinio_app_list</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_logs.html"><strong aria-hidden="true">7.2.1.1.5.</strong> epinio_app_logs</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_manifest.html"><strong aria-hidden="true">7.2.1.1.6.</strong> epinio_app_manifest</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_show.html"><strong aria-hidden="true">7.2.1.1.7.</strong> epinio_app_show</a></li><li class="chapter-item "><a href="../references/cli/epinio_app_update.html"><strong aria-hidden="true">7.2.1.1.8.</strong> epinio_app_update</a></li></ol></li><li class="chapter-item "><a href="../references/cli/epinio_config.html"><strong aria-hidden="true">7.2.1.2.</strong> epinio_config</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_config_colors.html"><strong aria-hidden="true">7.2.1.2.1.</strong> epinio_config_colors</a></li><li class="chapter-item "><a href="../references/cli/epinio_config_show.html"><strong aria-hidden="true">7.2.1.2.2.</strong> epinio_config_show</a></li><li class="chapter-item "><a href="../references/cli/epinio_config_update.html"><strong aria-hidden="true">7.2.1.2.3.</strong> epinio_config_update</a></li></ol></li><li class="chapter-item "><a href="../references/cli/epinio_info.html"><strong aria-hidden="true">7.2.1.3.</strong> epinio_info</a></li><li class="chapter-item "><a href="../references/cli/epinio_install-cert-manager.html"><strong aria-hidden="true">7.2.1.4.</strong> epinio_install-cert-manager</a></li><li class="chapter-item "><a href="../references/cli/epinio_install-ingress.html"><strong aria-hidden="true">7.2.1.5.</strong> epinio_install-ingress</a></li><li class="chapter-item "><a href="../references/cli/epinio_install.html"><strong aria-hidden="true">7.2.1.6.</strong> epinio_install</a></li><li class="chapter-item "><a href="../references/cli/epinio_namespace.html"><strong aria-hidden="true">7.2.1.7.</strong> epinio_namespace</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_namespace_create.html"><strong aria-hidden="true">7.2.1.7.1.</strong> epinio_namespace_create</a></li><li class="chapter-item "><a href="../references/cli/epinio_namespace_delete.html"><strong aria-hidden="true">7.2.1.7.2.</strong> epinio_namespace_delete</a></li><li class="chapter-item "><a href="../references/cli/epinio_namespace_list.html"><strong aria-hidden="true">7.2.1.7.3.</strong> epinio_namespace_list</a></li><li class="chapter-item "><a href="../references/cli/epinio_namespace_show.html"><strong aria-hidden="true">7.2.1.7.4.</strong> epinio_namespace_show</a></li></ol></li><li class="chapter-item "><a href="../references/cli/epinio_push.html"><strong aria-hidden="true">7.2.1.8.</strong> epinio_push</a></li><li class="chapter-item "><a href="../references/cli/epinio_server.html"><strong aria-hidden="true">7.2.1.9.</strong> epinio_server</a></li><li class="chapter-item "><a href="../references/cli/epinio_service.html"><strong aria-hidden="true">7.2.1.10.</strong> epinio_service</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/cli/epinio_service_bind.html"><strong aria-hidden="true">7.2.1.10.1.</strong> epinio_service_bind</a></li><li class="chapter-item "><a href="../references/cli/epinio_service_create.html"><strong aria-hidden="true">7.2.1.10.2.</strong> epinio_service_create</a></li><li class="chapter-item "><a href="../references/cli/epinio_service_delete.html"><strong aria-hidden="true">7.2.1.10.3.</strong> epinio_service_delete</a></li><li class="chapter-item "><a href="../references/cli/epinio_service_list.html"><strong aria-hidden="true">7.2.1.10.4.</strong> epinio_service_list</a></li><li class="chapter-item "><a href="../references/cli/epinio_service_show.html"><strong aria-hidden="true">7.2.1.10.5.</strong> epinio_service_show</a></li><li class="chapter-item "><a href="../references/cli/epinio_service_unbind.html"><strong aria-hidden="true">7.2.1.10.6.</strong> epinio_service_unbind</a></li></ol></li><li class="chapter-item "><a href="../references/cli/epinio_target.html"><strong aria-hidden="true">7.2.1.11.</strong> epinio_target</a></li><li class="chapter-item "><a href="../references/cli/epinio_uninstall.html"><strong aria-hidden="true">7.2.1.12.</strong> epinio_uninstall</a></li><li class="chapter-item "><a href="../references/cli/epinio_version.html"><strong aria-hidden="true">7.2.1.13.</strong> epinio_version</a></li></ol></li></ol></li><li class="chapter-item "><a href="../references/supported-apps.html"><strong aria-hidden="true">7.3.</strong> Supported Applications</a></li><li class="chapter-item "><a href="../references/manifests.html"><strong aria-hidden="true">7.4.</strong> Application Manifests</a></li><li class="chapter-item "><a href="../references/services.html"><strong aria-hidden="true">7.5.</strong> Services</a></li><li class="chapter-item "><a href="../references/api.html"><strong aria-hidden="true">7.6.</strong> API</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Epinio - the application development engine for Kubernetes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/epinio/docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/epinio/docs/edit/main/src/explanations/advanced.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="epinio-advanced-topics"><a class="header" href="#epinio-advanced-topics">Epinio, Advanced Topics</a></h1>
<h2 id="contents"><a class="header" href="#contents">Contents</a></h2>
<p>TODO: Do the same for Minio and list storage class requirements (WaitForFirstConsumer). Add links to upstream docs.
TODO: Explain how to configure external S3 storage.
TODO: Consider doing this in a separate document about the components. Or even, one document per components and links here.</p>
<ul>
<li><a href="#epinio-advanced-topics">Epinio, Advanced Topics</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#epinio-installed-components">Epinio installed components</a>
<ul>
<li><a href="#traefik">Traefik</a></li>
<li><a href="#linkerd">Linkerd</a></li>
<li><a href="#epinio">Epinio</a></li>
<li><a href="#cert-manager">Cert Manager</a></li>
<li><a href="#kubed">Kubed</a></li>
<li><a href="#google-service-broker">Google Service Broker</a></li>
<li><a href="#minibroker">Minibroker</a></li>
<li><a href="#service-catalog">Service Catalog</a></li>
<li><a href="#minio">Minio</a></li>
<li><a href="#container-registry">Container Registry</a></li>
<li><a href="#tekton">Tekton</a></li>
</ul>
</li>
<li><a href="#other-advanced-topics">Other Advanced Topics</a>
<ul>
<li><a href="#git-pushing">Git Pushing</a></li>
<li><a href="#traefik-and-linkerd">Traefik and Linkerd</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="epinio-installed-components"><a class="header" href="#epinio-installed-components">Epinio installed components</a></h2>
<h3 id="traefik"><a class="header" href="#traefik">Traefik</a></h3>
<p>When you installed Epinio, it looked at your cluster to see if you had
<a href="https://doc.traefik.io/traefik/providers/kubernetes-ingress/">Traefik</a>
running. If it wasn't there it installed it.</p>
<p>As Epinio only checks two namespaces for Traefik's presence, namely
<code>traefik</code> and <code>kube-system</code>, it is possible that it tries to install
it, despite the cluster having Traefik running. Just in an unexpected
place.</p>
<p>Note that having some other (non-Traefik) Ingress controller running
is <strong>not</strong> a reason to prevent Epinio from installing Traefik. All the
Ingresses used by Epinio expect to be handled by Traefik.</p>
<p>Also, the Traefik instance installed by Epinio, is configured to redirect all
http requests to https automatically (e.g. the requests to the Epinio API, and
the application routes). If you decide to use a Traefik instance which you
deployed, you have to set this up yourself, Epinio won't change your Traefik
installation in any way. Here are the relevant upstream docs for the redirection:</p>
<p>https://doc.traefik.io/traefik/routing/entrypoints/#redirection</p>
<h3 id="linkerd"><a class="header" href="#linkerd">Linkerd</a></h3>
<p>By default, Epinio installs <a href="https://linkerd.io/">Linkerd</a> on your cluster. The
various namespaces created by Epinio become part of the Linkerd Service Mesh and
thus all communication between pods is secured with mutualTLS.</p>
<h3 id="epinio"><a class="header" href="#epinio">Epinio</a></h3>
<p>The epinio binary is used as:</p>
<ul>
<li>a cli tool, used to push applications, create services etc.</li>
<li>the API server component which runs inside the cluster (invoked with the <code>epinio server</code> command)</li>
</ul>
<p>Epinio cli functionality is implemented using the endpoints provided by the Epinio API server
component. For example, when the user asks Epinio to &quot;push&quot; an application, the
cli will contact the &quot;Upload&quot;, &quot;Stage&quot; and &quot;Deploy&quot; endpoints of the Epinio API to upload the application code,
create a container image for the application using this code and run the application on the cluster.</p>
<p>The Epinio API server is running on the cluster and made accessible using Kubernetes resources like
Deployments, Services,  Ingresses and Secrets.</p>
<h3 id="cert-manager"><a class="header" href="#cert-manager">Cert Manager</a></h3>
<p><a href="https://cert-manager.io/docs/">Upstream documentation</a></p>
<p>The Cert manager component is deployed by Epinio and used to generate and renew the various Certificates needed in order to
serve the various accessible endpoints over TLS (e.g. the Epinio API server).</p>
<p>Epinio supports various options when it comes to certificate issuers (let's encrypt, private CA, bring your own CA, self signed certs).
Cert Manager simplifies the way we handle the various different certificate issuers within Epinio.</p>
<p>You can read more about certificate issuers here: <a href="../howtos/certificate_issuers.html">certificate issuers documentation</a></p>
<h3 id="kubed"><a class="header" href="#kubed">Kubed</a></h3>
<p><a href="https://github.com/kubeops/kubed">Upstream documentation</a></p>
<p>Kubed is installed by Epinio to keep secrets that are needed in more than
one namespace synced. For example, the TLS certificate of the <a href="#container-registry">Container Registry</a> is also needed
in the Tekton staging namespace, in order to trust the certificate when pushing the application images.</p>
<p>Kubed makes sure that if the source secret changes, the copy will change too.</p>
<p>Warning: this doesn't mean things will still work if you re-generate a secret manually. Secret rotation will be handled by Epinio in the future.</p>
<h3 id="google-service-broker"><a class="header" href="#google-service-broker">Google Service Broker</a></h3>
<p><a href="https://github.com/GoogleCloudPlatform/gcp-service-broker">Upstream project link</a></p>
<p>Many applications need additional services in order to work. Those services could be databases, cache servers, email gateways, log collecting applications or other.
The various cloud providers already offer such services. Being able to use them in the various Platforms as a Service (PaaS) in a unified way
gave birth to the concept of the (Open Service Broker API - aka osbapi)[https://www.openservicebrokerapi.org/]. This concept is adopted by various
providers among which, Google. There seems to be a shift towards the &quot;Operator&quot; pattern, e.g. Google seems to have moved its focus to the <a href="https://cloud.google.com/config-connector/docs/overview">Config Connector</a> as described at the top of the README <a href="https://github.com/googlearchive/k8s-service-catalog">here</a>.</p>
<p>Since Google's service broker still works and since the common interface provided by the <a href="#service-catalog">Service Catalog</a> makes it easy to integrate, Epinio
lets the user optionally install the Google service broker with the command <a href="../references/cli/epinio_enable_services-google.html"><code>epinio enable services-google</code></a>.</p>
<p>Warning: This service broker is not actively supported by Google anymore and may be removed from a future Epinio version.</p>
<h3 id="minibroker"><a class="header" href="#minibroker">Minibroker</a></h3>
<p><a href="https://github.com/kubernetes-sigs/minibroker">Upstream project link</a></p>
<p>This is another implementation of the Open Service Broker API which can also be optionally be installed by epinio with the command <a href="../references/cli/epinio_enable_services-incluster.html"><code>epinio enable services-incluster</code></a>.</p>
<p>Minibroker provisions services on the kubernetes cluster where Epinio is also running, using upstream helm charts. This can be useful for local development with Epinio, because it's fast and doesn't cost anything (services run locally).</p>
<h3 id="service-catalog"><a class="header" href="#service-catalog">Service Catalog</a></h3>
<p><a href="https://github.com/kubernetes-sigs/service-catalog">Upstream project link</a></p>
<p>The service catalog is the component that collects the various services provided by the various installed service brokers and presents them in a unified way to the user.
The service catalog is the component behind the <a href="../references/cli/epinio_service_list-classes.html"><code>epinio service list-classes</code></a> and <a href="../references/cli/epinio_service_list-plans.html"><code>epinio service list-plans</code></a> commands.</p>
<h3 id="minio"><a class="header" href="#minio">Minio</a></h3>
<p><a href="https://github.com/minio/minio">Upstream project link</a></p>
<p>Minio is a storage solution that implements the same API as <a href="https://aws.amazon.com/s3/">Amazon S3</a>.</p>
<p>When the user pushes an application using a source code directory (with the <a href="../references/cli/epinio_push.html"><code>epinio push</code></a> command), the first step taken by the cli is to put the source code into a tarball and upload that to the Epinio API server. The server copies that to the configured S3 storage to be used later during the staging of the application.</p>
<p>When installing Epinio, the user can choose to use an external S3 compatible storage or let Epinio install Minio on the cluster (<a href="../howtos/setup-external-s3.html">See here how</a>).</p>
<h3 id="container-registry"><a class="header" href="#container-registry">Container Registry</a></h3>
<p>The result of Epinio's application staging is a container image. This image is used to create a Kubernetes deployment to run the application code.
The <a href="#tekton">Tekton</a> pipeline requires that image to be written to some container registry (See also <a href="../explanations/detailed-push-process.html">Detailed push process</a>). </p>
<p>By default the Epinio installation deploys a container registry inside the Kubernetes cluster to make the process easy and fast.
If you want to look at how this registry is installed, have a look at the helm chart here:</p>
<ul>
<li>https://github.com/epinio/helm-charts/tree/main/chart/container-registry</li>
</ul>
<p>Epinio comes with two consumers of this registry:</p>
<ol>
<li>Tekton - pushing the images</li>
<li>Kubernetes - pulling the images when a Deployment is created for the Application</li>
</ol>
<p>Ideally all consumers will communicate with the registry over TLS to keep the communication encrypted.
Epinio controls the Tekton deployment and ensures that whatever CA is used to sign the registry certificate is trusted by Tekton. Achieving the same for Kubernetes however requires configuration that cannot happen from within the cluster, therefore Epinio has no way to ensure that. There are 3 options here:</p>
<ol>
<li>Let the Epinio user manually configure Kubernetes to trust the CA</li>
<li>Use a well-known trusted CA, so that no configuration is needed</li>
<li>Don't encrypt the communication at all</li>
</ol>
<p>Depending on the use case all 3 options may be valid:</p>
<ul>
<li>Option #1 can be selected when the user is installing Epinio with a custom tls-issuer. The user controls the CA and can make sure that this CA is trusted by the cluster before even installing Epinio.
In this case, since the user knows that Kubernetes will trust the registry's certificate, the <code>forceKubeInternalRegistryTLS</code> variable should be used during the installation.</li>
<li>Option #2 is valid when the tls-issuer used is one that uses a well known CA (e.g. <code>letsencrypt-production</code>). The <code>forceKubeInternalRegistryTLS</code> variable should be used in that case as well.</li>
<li>Option #3 is ok if the user works with a local cluster, doing development or just preparing a demo. In this case, to keep things simple and save the user from having to configure Kubernetes to trust a CA, Epinio let's Kubernetes access the registry without TLS. This is done by exposing the Registry as a NodePort service and letting Kubernetes access it on localhost. User shouldn't specify the <code>forceKubeInternalRegistryTLS</code> variable in this case (default is &quot;false&quot;). Even in this case, Tekton still accesses the registry over TLS.</li>
</ul>
<p>Epinio also allows the use of an external registry. The <a href="../howtos/setup-external-registry.html">instructions</a> on how such a registry can be set up are in a separate document.</p>
<h3 id="tekton"><a class="header" href="#tekton">Tekton</a></h3>
<ul>
<li><a href="https://github.com/tektoncd/pipeline">Upstream project link</a></li>
<li><a href="https://github.com/tektoncd/catalog/tree/main/task/buildpacks/0.3">Buildpacks pipeline</a></li>
</ul>
<p>Pushing an application to Kubernetes with Epinio involves various steps. One of them is staging, which is the process that creates a container image out of the application source code using <a href="https://buildpacks.io/">buildpacks</a>. Epinio runs the staging process via a <a href="https://github.com/tektoncd/catalog/tree/main/task/buildpacks/0.3">Tekton Pipeline</a>.</p>
<h2 id="other-advanced-topics"><a class="header" href="#other-advanced-topics">Other Advanced Topics</a></h2>
<h3 id="git-pushing"><a class="header" href="#git-pushing">Git Pushing</a></h3>
<p>The quick way of pushing an application, as explained at
<a href="../tutorials/quickstart.html#push-an-application">Quickstart: Push an application</a>, uses a local
directory containing a checkout of the application's sources.</p>
<p>Internally this is actually <a href="detailed-push-process.html">quite complex</a>. It
involves the creation and upload of a tarball from these sources by the client
to the Epinio server, copying into Epinio's internal (or external) S3 storage,
copying from that storage to a PersistentVolumeClaim to be used in the tekton pipeline for staging,
i.e. compilation and creation of the docker image to be used by the underlying kubernetes cluster.</p>
<p>The process is a bit different when using the Epinio client's &quot;git mode&quot;. In
this mode <a href="../references/cli/epinio_push.html"><code>epinio push</code></a> does not take a local directory of sources, but the
location of a git repository holding the sources, and the id of the revision to
use. The client then asks the Epinio server to pull those sources and store them to the
S3 storage. The rest of the process is the same.</p>
<p>The syntax is</p>
<pre><code>epinio push --name NAME --git GIT-REPOSITORY-URL,REVISION
</code></pre>
<p>For comparison all the relevant syntax:</p>
<pre><code>epinio push
epinio push MANIFEST-PATH
epinio push --name NAME
epinio push --name NAME --path DIRECTORY
epinio push --name NAME --git GIT-REPOSITORY-URL,REVISION
</code></pre>
<h3 id="traefik-and-linkerd"><a class="header" href="#traefik-and-linkerd">Traefik and Linkerd</a></h3>
<p>By default, with Epinio installing both Traefik and Linkerd, Epinio's
installation process ensures that the Traefik pods are included in the Linkerd
mesh, thus ensuring that external communication to applications is secured on
the leg between loadbalancer and application service.</p>
<p><strong>However</strong>, there are situations where Epinio does not install Traefik.
This can be because the user specified <code>--skip-traefik</code>, or because Epinio
detected a running Traefik, thus can forego its own.
The latter is possible, for example, when using <code>k3d</code> as cluster foundation.</p>
<p>In these situations the pre-existing Traefik is <strong>not</strong> part of the Linkerd
mesh. As a consequence the communication from loadbalancer to application
service is not as secure.</p>
<p>While it is possible to fix this, the fix requires access to the cluster in
general, and to Traefik's namespace specifically. In other words, permissions to
annotate the Traefik namespace are needed, as well as permissions to restart the
pods in that namespace. The latter is necessary, because Linkerd is not able to
inject itself into running pods. It can only intercept pod (re)starts.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>Assuming that Traefik's namespace is called <code>traefik</code>, with pods
<code>traefik-6f9cbd9bd4-z4zw8</code> and <code>svclb-traefik-q8g75</code>
the commands</p>
<pre><code>kubectl annotate namespace     traefik linkerd.io/inject=enabled
kubectl delete pod --namespace traefik traefik-6f9cbd9bd4-z4zw8 svclb-traefik-q8g75
</code></pre>
<p>will bring the Traefik in that namespace into Epinio's linkerd mesh.</p>
<p>Note that this recipe also works for a Traefik provided by <code>k3d</code>, in the
<code>kube-system</code> namespace.</p>
<p>While it is the namespace which is annotated, only restarted pods are affected
by that, i.e. Traefik's pods here. The other system pods continue to run as they
are.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../explanations/explanations.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../explanations/configuration.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../explanations/explanations.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../explanations/configuration.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
